"use strict";(globalThis.webpackChunk_w5s_website=globalThis.webpackChunk_w5s_website||[]).push([[6632],{780(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"packages/task/composing-tasks","title":"Composing Tasks","description":"Chaining and combining tasks","source":"@site/docs/packages/3-task/composing-tasks.mdx","sourceDirName":"packages/3-task","slug":"/packages/task/composing-tasks","permalink":"/std/fr/docs/packages/task/composing-tasks","draft":false,"unlisted":false,"editUrl":"https://github.com/w5s/std.git/tree/main/apps/website/docs/packages/3-task/composing-tasks.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Creating Tasks","permalink":"/std/fr/docs/packages/task/creating-tasks"},"next":{"title":"Running Tasks","permalink":"/std/fr/docs/packages/task/running-tasks"}}');var r=n(1085),t=n(1184),l=n(2940);const i={sidebar_position:2},o="Composing Tasks",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Transforming Values",id:"transforming-values",level:2},{value:"Task.map",id:"taskmap",level:3},{value:"Task.andThen",id:"taskandthen",level:3},{value:"Task.andRun",id:"taskandrun",level:3},{value:"Handling Errors",id:"handling-errors",level:2},{value:"Task.mapError",id:"taskmaperror",level:3},{value:"Task.orElse",id:"taskorelse",level:3},{value:"Task.mapResult",id:"taskmapresult",level:3},{value:"Parallel Execution",id:"parallel-execution",level:2},{value:"Task.all",id:"taskall",level:3},{value:"Task.any",id:"taskany",level:3},{value:"Task.allSettled",id:"taskallsettled",level:3},{value:"Utility Functions",id:"utility-functions",level:2},{value:"Task.ignore",id:"taskignore",level:3}];function k(e){const s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"composing-tasks",children:"Composing Tasks"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"Chaining and combining tasks"}),"\n"]}),"\n",(0,r.jsx)(l.n,{apiHref:"/api/task/namespace/task"}),"\n",(0,r.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(s.p,{children:["Tasks are designed to be composed together. Multiple operations can be chained without triggering execution until ",(0,r.jsx)(s.code,{children:"Task.run"})," is called."]}),"\n",(0,r.jsx)(s.h2,{id:"transforming-values",children:"Transforming Values"}),"\n",(0,r.jsx)(s.h3,{id:"taskmap",children:"Task.map"}),"\n",(0,r.jsx)(s.p,{children:"Transform the success value of a task:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst numberTask = Task.resolve(42);\nconst stringTask = Task.map(numberTask, (n) => `The answer is ${n}`);\n\nawait Task.run(stringTask); // Result.Ok('The answer is 42')\n"})}),"\n",(0,r.jsx)(s.h3,{id:"taskandthen",children:"Task.andThen"}),"\n",(0,r.jsx)(s.p,{children:"Chain tasks that depend on previous results:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst fetchUser = (id: string) => Task.create(async () => {\n  // ... fetch user\n  return Task.ok({ id, name: 'John' });\n});\n\nconst fetchPosts = (userId: string) => Task.create(async () => {\n  // ... fetch posts\n  return Task.ok([{ title: 'Post 1' }]);\n});\n\nconst userWithPosts = Task.andThen(\n  fetchUser('123'),\n  (user) => Task.map(\n    fetchPosts(user.id),\n    (posts) => ({ ...user, posts })\n  )\n);\n"})}),"\n",(0,r.jsx)(s.h3,{id:"taskandrun",children:"Task.andRun"}),"\n",(0,r.jsx)(s.p,{children:"Chain tasks when and the previous value:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst logStart = Task.create(() => Task.ok(console.log('Starting...')));\nconst mainTask = Task.create(() => Task.ok('result'));\nconst logEnd = Task.create(() => Task.ok(console.log('Done!')));\n\nconst workflow = Task.andRun(\n  Task.andRun(logStart, mainTask),\n  logEnd\n);\n"})}),"\n",(0,r.jsx)(s.h2,{id:"handling-errors",children:"Handling Errors"}),"\n",(0,r.jsx)(s.h3,{id:"taskmaperror",children:"Task.mapError"}),"\n",(0,r.jsx)(s.p,{children:"Transform the error type of a task:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst failingTask = Task.reject('string error');\nconst mappedError = Task.mapError(failingTask, (err) => new AnotherError(err));\n"})}),"\n",(0,r.jsx)(s.h3,{id:"taskorelse",children:"Task.orElse"}),"\n",(0,r.jsx)(s.p,{children:"Recover from errors:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst failingTask = Task.reject(new NetworkError());\nconst recovered = Task.orElse(failingTask, (error) => {\n  console.log('Recovering from:', error);\n  return Task.resolve('fallback value');\n});\n"})}),"\n",(0,r.jsx)(s.h3,{id:"taskmapresult",children:"Task.mapResult"}),"\n",(0,r.jsx)(s.p,{children:"Transform both success and error at once:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst task = Task.resolve(42);\nconst mapped = Task.mapResult(task, (result) => {\n  if (result.ok) {\n    return Result.Ok(result.value * 2);\n  }\n  return Result.Error(new WrappedError({ cause: result.error }));\n});\n"})}),"\n",(0,r.jsx)(s.h2,{id:"parallel-execution",children:"Parallel Execution"}),"\n",(0,r.jsx)(s.h3,{id:"taskall",children:"Task.all"}),"\n",(0,r.jsx)(s.p,{children:"Run multiple tasks in parallel and collect all results:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst tasks = [\n  Task.resolve(1),\n  Task.resolve(2),\n  Task.resolve(3),\n];\n\nconst allResults = Task.all(tasks);\nawait Task.run(allResults); // Result.Ok([1, 2, 3])\n\n// If any task fails, the whole operation fails\nconst withFailure = Task.all([\n  Task.resolve(1),\n  Task.reject('error'),\n]);\nawait Task.run(withFailure); // Result.Error('error')\n"})}),"\n",(0,r.jsx)(s.h3,{id:"taskany",children:"Task.any"}),"\n",(0,r.jsx)(s.p,{children:"Get the first successful result:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst first = Task.any([\n  Task.reject('error 1'),\n  Task.resolve('success'),\n  Task.reject('error 2'),\n]);\nawait Task.run(first); // Result.Ok('success')\n"})}),"\n",(0,r.jsx)(s.h3,{id:"taskallsettled",children:"Task.allSettled"}),"\n",(0,r.jsx)(s.p,{children:"Run all tasks and collect all results (success or failure):"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst settled = Task.allSettled([\n  Task.resolve(1),\n  Task.reject('error'),\n  Task.resolve(3),\n]);\nawait Task.run(settled);\n// Result.Ok([\n//   Result.Ok(1),\n//   Result.Error('error'),\n//   Result.Ok(3)\n// ])\n"})}),"\n",(0,r.jsx)(s.h2,{id:"utility-functions",children:"Utility Functions"}),"\n",(0,r.jsx)(s.h3,{id:"taskignore",children:"Task.ignore"}),"\n",(0,r.jsx)(s.p,{children:"Discard the result value:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import { Task } from '@w5s/task';\n\nconst task = Task.resolve(42);\nconst ignored = Task.ignore(task);\nawait Task.run(ignored); // Result.Ok(undefined)\n"})})]})}function u(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(k,{...e})}):k(e)}},2940(e,s,n){n.d(s,{n:()=>c});var a=n(2436),r=n(2196),t=n(396);const l="badge_qV9W",i="apiLink_d4om";var o=n(1085);function c(e){const s=(0,t.default)(),{siteConfig:n}=s;return(0,o.jsxs)(o.Fragment,{children:[null==e.apiHref?null:(0,o.jsxs)(a.default,{className:i,to:`${n.url}${n.baseUrl.replace(/\/$/,"")}${e.apiHref}`,children:["API ",(0,o.jsx)(r.A,{})]}),["npm-version","npm-license","bundle-size"].map(n=>(({siteConfig:e},s,n)=>{const a={className:l,key:n.badgeType},r=n.badgeStyle??"flat-square";if(null!=s.packageName)switch(n.badgeType){case"bundle-size":return(0,o.jsx)("img",{...a,alt:"Bundle size",src:`https://img.shields.io/bundlephobia/minzip/${encodeURIComponent(s.packageName)}?style=${r}`});case"npm-license":return(0,o.jsx)("img",{...a,alt:"NPM License",src:`https://img.shields.io/npm/l/${encodeURIComponent(s.packageName)}?style=${r}`});case"npm-version":return(0,o.jsx)("img",{...a,alt:"Github version",src:`https://img.shields.io/npm/v/${encodeURIComponent(s.packageName)}?style=${r}`})}return""})(s,e,{badgeType:n}))]})}},1184(e,s,n){n.d(s,{R:()=>l,x:()=>i});var a=n(4041);const r={},t=a.createContext(r);function l(e){const s=a.useContext(t);return a.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),a.createElement(t.Provider,{value:s},e.children)}}}]);